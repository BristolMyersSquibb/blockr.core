<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2. Create a block • blockr.core</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="create-block_files/libs/quarto-html/popper.min.js"></script><script src="create-block_files/libs/quarto-html/tippy.umd.min.js"></script><link href="create-block_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="create-block_files/libs/quarto-html/light-border.css" rel="stylesheet">
<script src="create-block_files/libs/quarto-diagram/mermaid.min.js"></script><script src="create-block_files/libs/quarto-diagram/mermaid-init.js"></script><link href="create-block_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Create a block">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.5.0/mermaid.min.js" integrity="sha512-3EZqKCkk3nMLmbrI7mfry81KH7dkzy/BoDfQrodwLQnS/RbsVlERdYP6J0oiJegRUxSOmx7Y35WNbVKSw7mipw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blockr.core</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/get-started.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/create-block.html">Create a block</a></li>
    <li><a class="dropdown-item" href="../articles/blocks-registry.html">Browse for blocks</a></li>
    <li><a class="dropdown-item" href="../articles/extend-blockr.html">Extend blockr</a></li>
    <li><a class="dropdown-item" href="../articles/testing-blocks.html">Testing blocks</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BristolMyersSquibb/blockr.core/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>2. Create a block</h1>




      <small class="dont-index">Source: <a href="https://github.com/BristolMyersSquibb/blockr.core/blob/main/vignettes/create-block.qmd" class="external-link"><code>vignettes/create-block.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bristolmyerssquibb.github.io/blockr.core">blockr.core</a></span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level2"><h2 id="creating-blocks">Creating blocks<a class="anchor" aria-label="anchor" href="#creating-blocks"></a>
</h2>
<p><strong>Note:</strong> If you are not already familiar with <a href="https://shiny.posit.co/r/articles/improve/modules/" class="external-link">Shiny modules</a>, it is recommended you familiarize yourself with them before continuing with this section.</p>
<p><code>blockr.core</code> is built on top of Shiny. At it’s heart, a <strong>block</strong> is nothing more than a specialized Shiny <strong>module</strong> that returns two additional values:</p>
<ul>
<li>
<strong>An expression</strong> (called “expr”), a reactive expression defining a blocks computation. This allows R code to be exported and data analyses to be recreated, outside of blockr and a reactive context.</li>
<li>
<strong>A state object</strong> (called “state”), a list of reactive values tracking user inputs. This allows blocks to separate user-defined state from inputs specified by blocks.</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p>
<figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  subgraph block[Block]
    subgraph ctor[constructor]
      block_ui[UI]
      subgraph block_server[server]
        blk_state[State]
        blk_expr[Expression]
      end
    end
  end
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>While blocks <em>return</em> the “expr” and “state” values, blocks <em>consist</em> of three elements:</p>
<ol type="1">
<li>A <strong>UI function</strong> to define the user interface.</li>
<li>A <strong>Server function</strong> to handle reactive logic that returns an expression and state object.</li>
<li>A <strong>Constructor function</strong> wraps the UI and server to initialize the block state.</li>
</ol>
<p>Now, let’s go through each element, building up a block template as we go.</p>
<section class="level3"><h3 id="ui-function">UI function<a class="anchor" aria-label="anchor" href="#ui-function"></a>
</h3>
<p>A UI function in blockr is the same as a UI function in a Shiny module. This means that:</p>
<ul>
<li>The UI function signature is expected to contain a single <code>id</code> argument, which can be used with <code><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">shiny::NS()</a></code> to construct namespaced IDs.</li>
<li>A call to appropriate shiny UI functions is expected that return <code>shiny.tag</code> or <code>shiny.tag.list</code> objects, typically via the use of <code><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">shiny::tagList()</a></code> in the UI to list separate UI elements.</li>
</ul>
<p>Let’s start to build our block template:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tagList</span><span class="op">(</span></span>
<span>    <span class="co"># Wrap widgets in `tagList()`</span></span>
<span>    <span class="fu">textInput</span><span class="op">(</span></span>
<span>      <span class="fu">NS</span><span class="op">(</span><span class="va">id</span>, <span class="st">"my_input"</span><span class="op">)</span> <span class="co"># Use `shiny::NS()` to construct namespaces</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</section><section class="level3"><h3 id="server-function">Server function<a class="anchor" aria-label="anchor" href="#server-function"></a>
</h3>
<p>As inputs, a server function takes an id and any additional inputs from other blocks (e.g., data). For example, for the blocks shipped with blockr.core, this would result in zero inputs for a <strong>data</strong> block, one for a <strong>transform</strong> block such as a select block, two for a <strong>join</strong> block and the special argument <code>...args</code> for <strong>variadic</strong> blocks, such as an <code>rbind</code> block.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p>
<figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
  data_blk[data block 1]
  data_blk_2[data block 2]
  data_blk_3[data block 3]
  data_blk_4[data block 4]
  select_blk[select block]
  join_blk[join block]
  rbind_blk[rbind block]
  data_blk --&gt; |data| select_blk
  data_blk_2 --&gt;|data1| join_blk
  data_blk_3 --&gt; |data2| join_blk

  data_blk --&gt; |1| rbind_blk
  select_blk --&gt; |2| rbind_blk
  data_blk_4 --&gt; |3| rbind_blk
  join_blk --&gt; |4| rbind_blk
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>A server function should return as output a <code>moduleServer()</code> call, defining:</p>
<ul>
<li>
<strong>expr</strong>: A quoted reactive expression representing the block’s computation. Data names should match between expression and the top-level server function arguments.</li>
<li>
<strong>state</strong>: A list of reactive values tracking user selections. The set of returned values from the <strong>state</strong> should match (both in count and names) that of the constructor signature.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Reactive logic goes here</span></span>
<span></span>
<span>    <span class="co"># Return a list with "expr" and "state"</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      expr <span class="op">=</span> <span class="fu">reactive</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identity.html" class="external-link">identity</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        input_one <span class="op">=</span> <span class="fu">reactive</span><span class="op">(</span><span class="fu">input_one</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        input_two <span class="op">=</span> <span class="fu">reactive</span><span class="op">(</span><span class="fu">input_two</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>Many options exist to build expressions, such as using tools offered by the <code>rlang</code> package or by passing a string to <code><a href="https://rdrr.io/r/base/parse.html" class="external-link">base::parse()</a></code>. As a block developer you are free to choose the tools that your prefer, as long as the evaluated expression returns non-reactive R code which can be executed outside of blockr.</p>
<p>The state is needed for <strong>serialisation</strong> and <strong>deserialization</strong> to respectively save and restore the state of a blockr application.</p>
</section><section class="level3"><h3 id="constructor-function">Constructor function<a class="anchor" aria-label="anchor" href="#constructor-function"></a>
</h3>
<p>The <strong>constructor</strong> function wraps the UI and server functions and initializes the block. Note that both <code>server</code> and <code>ui</code> are <a href="https://adv-r.hadley.nz/environments.html#function-environments" class="external-link">closures</a> and therefore may refer to names bound in the constructor scope (e.g. <code>dataset</code> and <code>choices</code>).</p>
<p>It should expose as arguments anything the user might set via the UI to control the block <strong>state</strong>. In other words, any inputs in the UI function, should have a corresponding argument in the constructor function. On the other hand, inputs from other blocks should not be exposed as arguments, as these are dynamically provided in the server function.</p>
<p>The return value should be a call to <code><a href="../reference/new_block.html">new_block()</a></code> (or if applicable a call to the more specific <em>virtual</em> constructors <code><a href="../reference/new_block.html">new_data_block()</a></code>, <code><a href="../reference/new_block.html">new_transform_block()</a></code>, etc.).</p>
<p>We can finish our block template:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>example_constructor <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">ui_state =</span> <span class="fu">character</span>(), ...) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  ui <span class="ot">&lt;-</span> <span class="cf">function</span>(id) { <span class="co">#nolint</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tagList</span>(<span class="fu">textInput</span>(<span class="fu">NS</span>(id, <span class="st">"ui_state"</span>)))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  server <span class="ot">&lt;-</span> <span class="cf">function</span>(id, data) {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">moduleServer</span>(id, <span class="cf">function</span>(input, output, session) {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reactive logic goes here</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Return a list with "expr" and "state"</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">expr =</span> <span class="fu">reactive</span>(<span class="fu">quote</span>(<span class="fu">identity</span>(data))),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">state =</span> <span class="fu">list</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>          <span class="co"># name must match what is defined in the constructor signature</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">ui_state =</span> <span class="sc">&lt;</span>STATE_VALUE<span class="sc">&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return call to `new_block()`</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_block</span>(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">server =</span> server,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ui =</span> ui,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">class =</span> <span class="st">"my_block"</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>The <code>...</code> is forwarded to <code>new_block</code> or any <code>new_*_block</code>.</p>
</section><section class="level3"><h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Putting this all together, we can create a <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">utils::head()</a></code> block, such as the one offered as <code><a href="../reference/new_head_block.html">new_head_block()</a></code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_head_block</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">6L</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/new_block.html">new_transform_block</a></span><span class="op">(</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">moduleServer</span><span class="op">(</span></span>
<span>        <span class="va">id</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">n_rows</span> <span class="op">&lt;-</span> <span class="fu">reactiveVal</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span>          <span class="fu">observeEvent</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">n</span>, <span class="fu">n_rows</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>          <span class="fu">observeEvent</span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu">updateNumericInput</span><span class="op">(</span></span>
<span>              inputId <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>              value <span class="op">=</span> <span class="fu">n_rows</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              min <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>              max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            expr <span class="op">=</span> <span class="fu">reactive</span><span class="op">(</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span>, n <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n_rows</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">)</span>,</span>
<span>            state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>              n <span class="op">=</span> <span class="va">n_rows</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">tagList</span><span class="op">(</span></span>
<span>        <span class="fu">numericInput</span><span class="op">(</span></span>
<span>          inputId <span class="op">=</span> <span class="fu">NS</span><span class="op">(</span><span class="va">id</span>, <span class="st">"n"</span><span class="op">)</span>,</span>
<span>          label <span class="op">=</span> <span class="st">"Number of rows"</span>,</span>
<span>          value <span class="op">=</span> <span class="va">n</span>,</span>
<span>          min <span class="op">=</span> <span class="fl">1L</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    dat_val <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">is.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">is.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    class <span class="op">=</span> <span class="st">"head_block"</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>Here, the state return value is a list of length 1, containing the current value for the only constructor argument. The current value for <code>n</code> is represented by a <code><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">shiny::reactiveVal()</a></code>, <code>n_rows()</code>, which is initialized with the values <code>n</code> in the constructor scope and updated on every change to <code>input$n</code>. Furthermore the <code>max</code> value for the <code><a href="https://rdrr.io/pkg/shiny/man/numericInput.html" class="external-link">shiny::numericInput()</a></code> field is updated on every change to the number of data rows.</p>
<p>A final <code>block</code> constructor argument of note might be <code>dat_val</code>, which is an optional function that can be passed which signals to the framework, if data passed to a block, can actually be processed by the block.</p>
<p>An app containing such a head block can be spun up as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/serve.html">serve</a></span><span class="op">(</span><span class="fu"><a href="../reference/new_head_block.html">new_head_block</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>For an example with multiple data inputs, refer to examples such as <code><a href="../reference/new_merge_block.html">new_merge_block()</a></code>. Such a binary block (with arguments <code>x</code> and <code>y</code>) can be explored in a standalone app (with nonsensical inputs) as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/serve.html">serve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/new_merge_block.html">new_merge_block</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/BOD.html" class="external-link">BOD</a></span>, y <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/ChickWeight.html" class="external-link">ChickWeight</a></span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>The <code>data</code> argument to <code><a href="../reference/serve.html">serve()</a></code> expects a list with names components that match the server function signature, i.e. <code>data</code> for <code><a href="../reference/new_head_block.html">new_head_block()</a></code> and <code>x</code>, <code>y</code> for <code><a href="../reference/new_merge_block.html">new_merge_block()</a></code>. Such names can be chosen freely by the block implementer (with the exception of integer-valued names, such as <code>`1`</code>, <code>`2`</code>, etc. which are reserved as positional arguments in <code>...args</code>).</p>
</section><section class="level3"><h3 id="more-complex-examples">More complex examples<a class="anchor" aria-label="anchor" href="#more-complex-examples"></a>
</h3>
<p>The above example showed how to embed a typical R function into a block. However, <code>blockr.core</code> can do much more. What about creating an entire block around an existing complex Shiny module?</p>
<p>In the following, we expose how you could wrap a block around <code>esquisse</code>, a <a href="https://dreamrs.github.io/esquisse/index.html" class="external-link">package</a> to build ggplot without coding. <code>esquisse</code> exports standalone <a href="https://dreamrs.github.io/esquisse/articles/shiny-usage.html#use-esquisse-as-a-shiny-module" class="external-link">modules</a> you can embed in any existing shiny app. Specifically, we consider <code>esquisse_server()</code> and <code>esquisse_ui()</code>. <code>esquisse_server()</code> needs some rectangular data as input and returns a list of 3 elements: modified data, code plot and filters code:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">esquisse</span><span class="fu">::</span><span class="fu">esquisse_server</span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"esquisse"</span>,</span>
<span>  data_rv <span class="op">=</span> <span class="va">data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">code_filters</span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">code_plot</span></span></code></pre></div>
<p>When filters are applied with <code>esquisse</code>, the returned data are filtered, otherwise the module returns the unchanged input data. Based on what we already know about constructing block, we can write the following code for the constructor server function. This block will have 1 input materialized as the <code>data</code> parameter (data coming from the upstream block):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esquisse_block_server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span></span>
<span>    <span class="va">id</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">esquisse</span><span class="fu">::</span><span class="fu">esquisse_server</span><span class="op">(</span></span>
<span>        id <span class="op">=</span> <span class="st">"esquisse"</span>,</span>
<span>        data_rv <span class="op">=</span> <span class="va">data</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        expr <span class="op">=</span> <span class="fu">reactive</span><span class="op">(</span><span class="op">{</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>              dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">.</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              filters <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">filters</span><span class="op">)</span></span>
<span>            <span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>              filters <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">code_plot</span>,</span>
<span>              dat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">data</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span>,</span>
<span>        state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>In the server module, we first call <code>esquisse_server()</code>. Then, the most technical part is to construct the returned value. We decide that the block is <strong>stateless</strong>, as in any case <code>esquisse</code> doesn’t handle starting the module in a specific state, so that would be useless to save something. The <strong>expression</strong> is composed of 2 elements, the data and plot code. By default, if we assume our <code>esquisse</code> block to be a <code>transform_block,</code> <code>blockr.core</code> uses <code>block_output.transform_block</code> to display the block output:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">block_output.transform_block</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">result</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">session</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">dt_result</span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">dat</span>, <span class="va">session</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This S3 <a href="https://adv-r.hadley.nz/s3.html#s3-methods" class="external-link">method</a> can only handle rectangular data and not a list as we specified in <code>esquisse_block_server()</code>. We therefore have to create a new class and constructor for our <code>esquisse</code> block, we call it <code>complex_block</code> and <code>new_complex_block()</code>, respectively:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_complex_block</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">server</span>, <span class="va">ui</span>, <span class="va">class</span>, <span class="va">ctor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">sys.parent</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/new_block.html">new_block</a></span><span class="op">(</span><span class="va">server</span>, <span class="va">ui</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">class</span>, <span class="st">"complex_block"</span><span class="op">)</span>, <span class="va">ctor</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>As you may notice, <code>new_complex_block()</code> is very similar to <code>new_transform_block</code>, the only difference being the class name. We subsequently define a new S3 method for <code><a href="../reference/block_ui.html">block_output()</a></code>, which is able to process our <code>list</code> result (don’t forget the <code>@export</code> roxygen tag):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @export</span></span>
<span><span class="va">block_output.complex_block</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">result</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">session</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu">renderPrint</span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">filters</span><span class="op">)</span></span>
<span>  <span class="co"># result must come at the end of the output list if you have multiple outputs</span></span>
<span>  <span class="va">session</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">dt_result</span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">dat</span>, <span class="va">session</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>We also provide the UI counter part. Here you could go for more fancy layout but for sake of simplicity, we design a minimalistic UI:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @export</span></span>
<span><span class="va">block_ui.complex_block</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tagList</span><span class="op">(</span></span>
<span>    <span class="fu">h1</span><span class="op">(</span><span class="st">"Transformed data from {esquisse}"</span><span class="op">)</span>,</span>
<span>    <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html" class="external-link">dataTableOutput</a></span><span class="op">(</span><span class="fu">NS</span><span class="op">(</span><span class="va">id</span>, <span class="st">"result"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">verbatimTextOutput</span><span class="op">(</span><span class="fu">NS</span><span class="op">(</span><span class="va">id</span>, <span class="st">"filters"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>The UI function of our constructor is simple, even though you would be totally free to customize it further:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esquisse_block_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tagList</span><span class="op">(</span></span>
<span>    <span class="fu">esquisse</span><span class="fu">::</span><span class="fu">esquisse_ui</span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="fu">NS</span><span class="op">(</span><span class="va">id</span>, <span class="st">"esquisse"</span><span class="op">)</span>, </span>
<span>      header <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># dont display gadget title</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>Finally our new <code>esquisse</code> block constructor given by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_esquisse_block</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">new_complex_block</span><span class="op">(</span></span>
<span>    server <span class="op">=</span> <span class="va">esquisse_block_server</span>,</span>
<span>    ui <span class="op">=</span> <span class="va">esquisse_block_ui</span>,</span>
<span>    class <span class="op">=</span> <span class="st">"esquisse_block"</span>,</span>
<span>    dat_valid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    allow_empty_state <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>To test our new block we call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/serve.html">serve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/new_board.html">new_board</a></span><span class="op">(</span></span>
<span>    blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      a <span class="op">=</span> <span class="fu"><a href="../reference/new_dataset_block.html">new_dataset_block</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>,</span>
<span>      b <span class="op">=</span> <span class="fu">new_esquisse_block</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    links <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/new_link.html">new_link</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"data"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>As closing remark, since the <code>esquisse</code> block is stateless, save and restore won’t work for this block.</p>
<div>
<blockquote>
<p><strong>Note</strong></p>
<p>The demo below runs with shinylive. Not all feature may work as expected due to compatibility issues with webR.</p>
</blockquote>
</div>
<div class="cell">
<div class="cell-output-display">
<iframe class="border border-5 rounded shadow-lg" src="https://shinylive.io/r/app/#h=0&amp;code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAdzgCMAnRRASwgGdSoAbbgCgA6YOtyIEA1gwzEGcIbgAEs1EXYKAvAqEALUqVTtEAeiMEAnhElQMAcxaltAVzoYWRIyLGSMtOliNCAJQCENwsjFAMZnyeElIycMGh4QyR0XDsAI6OLOzsiSFhEVF8qKKk3GZJGdm5+QD6seL1+QwAbnAMCgA8ALQKAGaOEASkbhB8LAAmilNQXIEKICEKCjBEU47ccADKnR0MghCrq9O4KydDI2MkkxCojqSKRI8PTwr5eeOLy8cnq7J2FtSGo+goajk8nBmBC6nAWvtOkd-v9photGBYVD5BcUQo5lx6u10QSoLiTkk8WFOMi8eCAB6oLqaWRQUYsDp8X50k50bJEci0nmramkIXC1YE9FQdgYUkYAapeB8DB8AmBQLnP4S1YDFjccgMNSaVV6g2ddiUnWa8k80XiiVmw3GpQZYHsAAkxCm8LKAq1OpOUpZboNntJtrpVp50ZRAF8bdqUZx5nB0fbY6tY3GLkkcxAsQ0mvUcj1+ld2bdpj8LlwbAAZXJi8mF6GIVsllgOhRozQAOR2kxmGNbQUUke0cCgPuZCgAYgBBes7ACiCgAxPiSKR8bkylAzAobNObHAd2MKnIk1a8yEC9R6sQYGU4PTGqIJGXBsNKxNWgdFByRQCG4GV2GA0giFndgzFlVBIgoMVNQUDBUJrP573fLw+H-TpAJYYC+BAsDx0IIhn22N8mjHBRRigxRUIwW8IEwjsmi-CsbgmRj0NWTCnxfKiP3EcVcNnNjhIRdo8PJUtNAkrxOwDE5iLydEhAUiQcSTAl6jaHhewUPsAFV63rZTVh4UQHzgZ9SDMFouHIdEABUsGMlcLJQ1DcxCfN1wAcgUAABV8VAYUgQmLHJpHIwSsM-MFOPGIdFHpBi0KWWsoAbJtxW0ABGQQwBc1IOAGKD4CmfF5igQYGHIpZWxzMBE3+AARFzmFJFyoBEOAAHlXkePgB1SjFAWBII2pOA46HmFgYBc19SCG-QRrGs4MSdC1pt8iB-KC0LGSgyKIGLF51tIWKKNfBLxA4n8uL4dLXSBA1FE+dhviyv4vvGD1LreD0dqNL9ZAgGcAAUGDYMVJoNEH9WdK1NwRncYEcThaPItN5gUBw0woaqiAGAnJwUIHHgUUUezJswXgUbQoA6NZgRYF9KeGkELn+khAe5j10a-KZSCJUN4Ylj0CU+jJvpIZjcNpTC6CISIpnFJoXXtSM6s0TDSXyMWmkmWHLS81Y6HRViskhIthL4WMZpFNhxG1vLI0wsJLGKsk8AxOh5AxCNWvJG8QkCMA4wAXSAA" style="zoom: 0.75;" width="100%" height="1100px"></iframe>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Bennett, David Granjon, Christoph Sax, Bristol Myers Squibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
